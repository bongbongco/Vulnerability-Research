# SHA-2017 Teaser-Round Network

## Website Attack write up
문제 풀이를 위한 [pcap](https://github.com/bongbongco/Vulnerability-Research/raw/master/ctf/sha-2017-teaser-round/websiteattack.tgz)파일이 주어진다.

>PCAP 은 Packet Capture 의미로 네트워크 트래픽을 캡쳐하기 위한
API 로 구성이 되어 있다. 윈도우로 포팅되어 있는 것은 WinPcap 이며, 유닉스 환경에서는 libpcap 이다. libpcap 과 winpcap 라이브러리를 이용하여 캡쳐된 패킷을 파일로 저장하거나, 저장된 패킷을 읽고 또는 다른 프로그램에서 라이브러리를 이용해 패킷파일을 분석/편집 등을 할 수 있다. 이를 이용한 대표적인 패킷 캡쳐 프로그램이 tcpdump 나 wireshark 이다.  
> 출처 : [패킷인사이드](http://www.packetinside.com/2010/02/pcap-파일을-파헤쳐-보자-그-첫번째-이야기.html)

와이어 샤크를 이용하여 pcap을 열어보면 TCP, IPA 패킷이 저장되어 있는 것을 확인할 수 있다. IPA 패킷 내용을 확인해보면 HTTP 패킷으로 보이므로 분석의 용이성을 위해서 HTTP 패킷으로 변환하여 분석하도록 한다.

> Wireshark -> Analyze -> Enabled Protocol -> GSM over IP 체크 해제
> 참고 URL
> [Data which has been sent over TCP\IP has been recognized by wireshark as "IPA" Protocol](https://ask.wireshark.org/questions/9240/data-which-has-been-sent-over-tcpip-has-been-recognized-by-wireshark-as-ipa-protocol)
> [[Malformed Packet: GSM over IP]](https://ask.wireshark.org/questions/2030/malformed-packet-gsm-over-ip)

패킷의 흐름을 살펴보면 다음과 같다.
```sequence
237->208: GET /?action=search&word=&sort=stock
Note right of 208: Encrypt/Encoding
208->237: 302 Found
237->208: GET /?action=display&what=[encrypt string]
```
여기서 *word*의 값만 변경되는 데 총 3개의 *word*를 요청한다.
```
kl
Trad
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
```
