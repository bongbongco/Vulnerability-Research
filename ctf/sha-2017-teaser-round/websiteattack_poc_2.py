from os import listdir
fileNames = listdir("/Users/seungyonglee/ctf/sha_2017/HTTP")

for fileName in fileNames:
    cipherString = fileName[23:]
    result = ""
    for I in range(len(cipherString) / 64 + 1):
            a = cipherString[I*64:(I+1)*64]
            b = "e4146d4252bafb3b38212df186497a7479d5e95af4796e7573a65e6849952032"
            c = "4141414141414141414141414141414141414141414141414141414141414141"
            for i in range(len(a) / 2):
                    aa = ord(a[i*2:i*2 + 2].decode('hex'))
                    bb = ord(b[i*2:i*2 + 2].decode('hex'))
                    cc = ord(c[i*2:i*2 + 2].decode('hex'))
    	
                    result = result + chr(aa ^ bb ^ cc)
    print result
